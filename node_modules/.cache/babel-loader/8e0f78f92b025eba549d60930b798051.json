{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/Bhargab kalita/Downloads/DAO/DAO/PROJECTDAO/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"C:/Users/Bhargab kalita/Downloads/DAO/DAO/PROJECTDAO/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/Bhargab kalita/Downloads/DAO/DAO/PROJECTDAO/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"C:/Users/Bhargab kalita/Downloads/DAO/DAO/PROJECTDAO/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/Users/Bhargab kalita/Downloads/DAO/DAO/PROJECTDAO/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _regeneratorRuntime from \"C:/Users/Bhargab kalita/Downloads/DAO/DAO/PROJECTDAO/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/Bhargab kalita/Downloads/DAO/DAO/PROJECTDAO/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { providerFromEngine, createFetchMiddleware } from '@toruslabs/base-controllers';\nimport { mergeMiddleware, createAsyncMiddleware, JRPCEngine } from '@toruslabs/openlogin-jrpc';\nimport { CHAIN_NAMESPACES, isHexStrict, WalletInitializationError } from '@web3auth/base';\nimport { BaseProvider } from '@web3auth/base-provider';\nimport { Transaction, Keypair, Message } from '@solana/web3.js';\nimport bs58 from 'bs58';\nimport { ethErrors } from 'eth-rpc-errors';\nimport nacl from '@toruslabs/tweetnacl-js';\n\nfunction createGetAccountsMiddleware(_ref) {\n  var getAccounts = _ref.getAccounts;\n  return createAsyncMiddleware( /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(request, response, next) {\n      var method, accounts;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              method = request.method;\n\n              if (!(method !== \"getAccounts\")) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt(\"return\", next());\n\n            case 3:\n              if (getAccounts) {\n                _context.next = 5;\n                break;\n              }\n\n              throw new Error(\"WalletMiddleware - opts.getAccounts not provided\");\n\n            case 5:\n              _context.next = 7;\n              return getAccounts(request);\n\n            case 7:\n              accounts = _context.sent;\n              response.result = accounts;\n              return _context.abrupt(\"return\", undefined);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x, _x2, _x3) {\n      return _ref5.apply(this, arguments);\n    };\n  }());\n}\n\nfunction createRequestAccountsMiddleware(_ref2) {\n  var requestAccounts = _ref2.requestAccounts;\n  return createAsyncMiddleware( /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(request, response, next) {\n      var method, accounts;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              method = request.method;\n\n              if (!(method !== \"requestAccounts\")) {\n                _context2.next = 3;\n                break;\n              }\n\n              return _context2.abrupt(\"return\", next());\n\n            case 3:\n              if (requestAccounts) {\n                _context2.next = 5;\n                break;\n              }\n\n              throw new Error(\"WalletMiddleware - opts.requestAccounts not provided\");\n\n            case 5:\n              _context2.next = 7;\n              return requestAccounts(request);\n\n            case 7:\n              accounts = _context2.sent;\n              response.result = accounts;\n              return _context2.abrupt(\"return\", undefined);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x4, _x5, _x6) {\n      return _ref6.apply(this, arguments);\n    };\n  }());\n}\n\nfunction createGenericJRPCMiddleware(targetMethod, handler) {\n  return createAsyncMiddleware( /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(request, response, next) {\n      var method, result;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              method = request.method;\n\n              if (!(method !== targetMethod)) {\n                _context3.next = 3;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", next());\n\n            case 3:\n              if (handler) {\n                _context3.next = 5;\n                break;\n              }\n\n              throw new Error(\"WalletMiddleware - \".concat(targetMethod, \" not provided\"));\n\n            case 5:\n              _context3.next = 7;\n              return handler(request);\n\n            case 7:\n              result = _context3.sent;\n              response.result = result;\n              return _context3.abrupt(\"return\", undefined);\n\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x7, _x8, _x9) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n}\n\nfunction createSolanaMiddleware(providerHandlers) {\n  var getAccounts = providerHandlers.getAccounts,\n      requestAccounts = providerHandlers.requestAccounts,\n      signTransaction = providerHandlers.signTransaction,\n      signAndSendTransaction = providerHandlers.signAndSendTransaction,\n      signAllTransactions = providerHandlers.signAllTransactions,\n      signMessage = providerHandlers.signMessage,\n      getPrivateKey = providerHandlers.getPrivateKey;\n  return mergeMiddleware([createRequestAccountsMiddleware({\n    requestAccounts: requestAccounts\n  }), createGetAccountsMiddleware({\n    getAccounts: getAccounts\n  }), createGenericJRPCMiddleware(\"signTransaction\", signTransaction), createGenericJRPCMiddleware(\"signAndSendTransaction\", signAndSendTransaction), createGenericJRPCMiddleware(\"signAllTransactions\", signAllTransactions), createGenericJRPCMiddleware(\"signMessage\", signMessage), createGenericJRPCMiddleware(\"solanaPrivateKey\", getPrivateKey)]);\n}\n\nfunction createChainSwitchMiddleware(_ref3) {\n  var addNewChainConfig = _ref3.addNewChainConfig,\n      switchSolanaChain = _ref3.switchSolanaChain;\n  return mergeMiddleware([createGenericJRPCMiddleware(\"addSolanaChain\", addNewChainConfig), createGenericJRPCMiddleware(\"switchSolanaChain\", switchSolanaChain)]);\n}\n\nfunction createAccountMiddleware(_ref4) {\n  var updatePrivatekey = _ref4.updatePrivatekey;\n  return mergeMiddleware([createGenericJRPCMiddleware(\"updateAccount\", updatePrivatekey)]);\n}\n\nfunction ownKeys$3(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$3(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys$3(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$3(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction createInjectedProviderProxyMiddleware(provider) {\n  return createAsyncMiddleware( /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(req, res, _next) {\n      var result;\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return provider.request(_objectSpread$3({}, req));\n\n            case 2:\n              result = _context4.sent;\n              res.result = result;\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function (_x10, _x11, _x12) {\n      return _ref8.apply(this, arguments);\n    };\n  }());\n}\n\nvar getPhantomHandlers = function getPhantomHandlers(injectedProvider) {\n  var providerHandlers = {\n    requestAccounts: function () {\n      var _requestAccounts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                return _context5.abrupt(\"return\", injectedProvider.publicKey ? [bs58.encode(injectedProvider.publicKey.toBytes())] : []);\n\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      function requestAccounts() {\n        return _requestAccounts.apply(this, arguments);\n      }\n\n      return requestAccounts;\n    }(),\n    getAccounts: function () {\n      var _getAccounts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                return _context6.abrupt(\"return\", injectedProvider.publicKey ? [bs58.encode(injectedProvider.publicKey.toBytes())] : []);\n\n              case 1:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6);\n      }));\n\n      function getAccounts() {\n        return _getAccounts.apply(this, arguments);\n      }\n\n      return getAccounts;\n    }(),\n    getPrivateKey: function () {\n      var _getPrivateKey = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                throw ethErrors.rpc.methodNotSupported();\n\n              case 1:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      function getPrivateKey() {\n        return _getPrivateKey.apply(this, arguments);\n      }\n\n      return getPrivateKey;\n    }(),\n    signTransaction: function () {\n      var _signTransaction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(req) {\n        var message, txn, transaction;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                message = bs58.decode(req.params.message);\n                txn = Transaction.from(message);\n                _context8.next = 4;\n                return injectedProvider.signTransaction(txn);\n\n              case 4:\n                transaction = _context8.sent;\n                return _context8.abrupt(\"return\", transaction);\n\n              case 6:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8);\n      }));\n\n      function signTransaction(_x13) {\n        return _signTransaction.apply(this, arguments);\n      }\n\n      return signTransaction;\n    }(),\n    signMessage: function () {\n      var _signMessage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(req) {\n        var _req$params, message;\n\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return injectedProvider.request({\n                  method: \"signMessage\",\n                  params: {\n                    message: (_req$params = req.params) === null || _req$params === void 0 ? void 0 : _req$params.message\n                  }\n                });\n\n              case 2:\n                message = _context9.sent;\n                return _context9.abrupt(\"return\", message);\n\n              case 4:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n\n      function signMessage(_x14) {\n        return _signMessage.apply(this, arguments);\n      }\n\n      return signMessage;\n    }(),\n    signAndSendTransaction: function () {\n      var _signAndSendTransaction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(req) {\n        var message, txn, txRes;\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                message = bs58.decode(req.params.message);\n                txn = Transaction.from(message);\n                _context10.next = 4;\n                return injectedProvider.signAndSendTransaction(txn);\n\n              case 4:\n                txRes = _context10.sent;\n                return _context10.abrupt(\"return\", {\n                  signature: txRes.signature\n                });\n\n              case 6:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10);\n      }));\n\n      function signAndSendTransaction(_x15) {\n        return _signAndSendTransaction.apply(this, arguments);\n      }\n\n      return signAndSendTransaction;\n    }(),\n    signAllTransactions: function () {\n      var _signAllTransactions = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(req) {\n        var _req$params2, _req$params3, txns, transaction;\n\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                if (!(!((_req$params2 = req.params) !== null && _req$params2 !== void 0 && _req$params2.message) || !((_req$params3 = req.params) !== null && _req$params3 !== void 0 && _req$params3.message.length))) {\n                  _context11.next = 2;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidParams(\"message\");\n\n              case 2:\n                txns = req.params.message.map(function (msg) {\n                  var decodedMsg = bs58.decode(msg);\n                  return Transaction.from(decodedMsg);\n                });\n                _context11.next = 5;\n                return injectedProvider.signAllTransactions(txns);\n\n              case 5:\n                transaction = _context11.sent;\n                return _context11.abrupt(\"return\", transaction);\n\n              case 7:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11);\n      }));\n\n      function signAllTransactions(_x16) {\n        return _signAllTransactions.apply(this, arguments);\n      }\n\n      return signAllTransactions;\n    }()\n  };\n  return providerHandlers;\n};\n\nfunction ownKeys$2(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys$2(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$2(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar PhantomInjectedProvider = /*#__PURE__*/function (_BaseProvider) {\n  _inherits(PhantomInjectedProvider, _BaseProvider);\n\n  var _super = _createSuper(PhantomInjectedProvider);\n\n  function PhantomInjectedProvider(_ref) {\n    _classCallCheck(this, PhantomInjectedProvider);\n\n    var config = _ref.config,\n        state = _ref.state;\n    return _super.call(this, {\n      config: {\n        chainConfig: _objectSpread$2(_objectSpread$2({}, config.chainConfig), {}, {\n          chainNamespace: CHAIN_NAMESPACES.SOLANA\n        })\n      },\n      state: state\n    });\n  }\n\n  _createClass(PhantomInjectedProvider, [{\n    key: \"switchChain\",\n    value: function () {\n      var _switchChain = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(_) {\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                return _context12.abrupt(\"return\", Promise.resolve());\n\n              case 1:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12);\n      }));\n\n      function switchChain(_x17) {\n        return _switchChain.apply(this, arguments);\n      }\n\n      return switchChain;\n    }()\n  }, {\n    key: \"setupProvider\",\n    value: function () {\n      var _setupProvider = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(injectedProvider) {\n        var providerHandlers, solanaMiddleware, injectedProviderProxy, engine, provider;\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                providerHandlers = getPhantomHandlers(injectedProvider);\n                solanaMiddleware = createSolanaMiddleware(providerHandlers);\n                injectedProviderProxy = createInjectedProviderProxyMiddleware(injectedProvider);\n                engine = new JRPCEngine();\n                engine.push(solanaMiddleware);\n                engine.push(injectedProviderProxy);\n                provider = providerFromEngine(engine);\n                this.updateProviderEngineProxy(provider);\n                _context13.next = 10;\n                return this.lookupNetwork(injectedProvider);\n\n              case 10:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      function setupProvider(_x18) {\n        return _setupProvider.apply(this, arguments);\n      }\n\n      return setupProvider;\n    }()\n  }, {\n    key: \"lookupNetwork\",\n    value: function () {\n      var _lookupNetwork = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(_) {\n        var chainConfig;\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                chainConfig = this.config.chainConfig;\n                this.update({\n                  chainId: chainConfig.chainId\n                });\n                return _context14.abrupt(\"return\", chainConfig.chainId || \"\");\n\n              case 3:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14, this);\n      }));\n\n      function lookupNetwork(_x19) {\n        return _lookupNetwork.apply(this, arguments);\n      }\n\n      return lookupNetwork;\n    }()\n  }]);\n\n  return PhantomInjectedProvider;\n}(BaseProvider);\n\nvar getTorusHandlers = function getTorusHandlers(injectedProvider) {\n  var providerHandlers = {\n    requestAccounts: function () {\n      var _requestAccounts2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15() {\n        var accounts;\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                _context15.next = 2;\n                return injectedProvider.request({\n                  method: \"solana_requestAccounts\",\n                  params: {}\n                });\n\n              case 2:\n                accounts = _context15.sent;\n                return _context15.abrupt(\"return\", accounts);\n\n              case 4:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15);\n      }));\n\n      function requestAccounts() {\n        return _requestAccounts2.apply(this, arguments);\n      }\n\n      return requestAccounts;\n    }(),\n    getAccounts: function () {\n      var _getAccounts2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16() {\n        var accounts;\n        return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                _context16.next = 2;\n                return injectedProvider.request({\n                  method: \"solana_accounts\",\n                  params: {}\n                });\n\n              case 2:\n                accounts = _context16.sent;\n                return _context16.abrupt(\"return\", accounts);\n\n              case 4:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16);\n      }));\n\n      function getAccounts() {\n        return _getAccounts2.apply(this, arguments);\n      }\n\n      return getAccounts;\n    }(),\n    getPrivateKey: function () {\n      var _getPrivateKey2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17() {\n        return _regeneratorRuntime().wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                throw ethErrors.rpc.methodNotSupported();\n\n              case 1:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17);\n      }));\n\n      function getPrivateKey() {\n        return _getPrivateKey2.apply(this, arguments);\n      }\n\n      return getPrivateKey;\n    }(),\n    signMessage: function () {\n      var _signMessage2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18(req) {\n        var _req$params, message;\n\n        return _regeneratorRuntime().wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                _context18.next = 2;\n                return injectedProvider.request({\n                  method: \"sign_message\",\n                  params: {\n                    data: (_req$params = req.params) === null || _req$params === void 0 ? void 0 : _req$params.message\n                  }\n                });\n\n              case 2:\n                message = _context18.sent;\n                return _context18.abrupt(\"return\", message);\n\n              case 4:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18);\n      }));\n\n      function signMessage(_x20) {\n        return _signMessage2.apply(this, arguments);\n      }\n\n      return signMessage;\n    }(),\n    signTransaction: function () {\n      var _signTransaction2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19(req) {\n        var _req$params2, message, response, buf, sendTx;\n\n        return _regeneratorRuntime().wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                if ((_req$params2 = req.params) !== null && _req$params2 !== void 0 && _req$params2.message) {\n                  _context19.next = 2;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidParams(\"message\");\n\n              case 2:\n                message = bs58.decode(req.params.message).toString(\"hex\");\n                _context19.next = 5;\n                return injectedProvider.request({\n                  method: \"sign_transaction\",\n                  params: {\n                    message: message\n                  }\n                });\n\n              case 5:\n                response = _context19.sent;\n                buf = Buffer.from(response, \"hex\");\n                sendTx = Transaction.from(buf);\n                return _context19.abrupt(\"return\", sendTx);\n\n              case 9:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19);\n      }));\n\n      function signTransaction(_x21) {\n        return _signTransaction2.apply(this, arguments);\n      }\n\n      return signTransaction;\n    }(),\n    signAndSendTransaction: function () {\n      var _signAndSendTransaction2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee20(req) {\n        var _req$params3, message, response;\n\n        return _regeneratorRuntime().wrap(function _callee20$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                if ((_req$params3 = req.params) !== null && _req$params3 !== void 0 && _req$params3.message) {\n                  _context20.next = 2;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidParams(\"message\");\n\n              case 2:\n                message = bs58.decode(req.params.message).toString(\"hex\");\n                _context20.next = 5;\n                return injectedProvider.request({\n                  method: \"send_transaction\",\n                  params: {\n                    message: message\n                  }\n                });\n\n              case 5:\n                response = _context20.sent;\n                return _context20.abrupt(\"return\", {\n                  signature: response\n                });\n\n              case 7:\n              case \"end\":\n                return _context20.stop();\n            }\n          }\n        }, _callee20);\n      }));\n\n      function signAndSendTransaction(_x22) {\n        return _signAndSendTransaction2.apply(this, arguments);\n      }\n\n      return signAndSendTransaction;\n    }(),\n    signAllTransactions: function () {\n      var _signAllTransactions2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee21(req) {\n        var _req$params4, _req$params5, messages, _iterator, _step, transaction, message, response;\n\n        return _regeneratorRuntime().wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                if (!(!((_req$params4 = req.params) !== null && _req$params4 !== void 0 && _req$params4.message) || !((_req$params5 = req.params) !== null && _req$params5 !== void 0 && _req$params5.message.length))) {\n                  _context21.next = 2;\n                  break;\n                }\n\n                throw ethErrors.rpc.invalidParams(\"message\");\n\n              case 2:\n                messages = [];\n                _iterator = _createForOfIteratorHelper(req.params.message);\n\n                try {\n                  for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                    transaction = _step.value;\n                    message = bs58.decode(transaction).toString(\"hex\");\n                    messages.push(message);\n                  }\n                } catch (err) {\n                  _iterator.e(err);\n                } finally {\n                  _iterator.f();\n                }\n\n                _context21.next = 7;\n                return injectedProvider.request({\n                  method: \"sign_all_transactions\",\n                  params: {\n                    message: messages\n                  }\n                });\n\n              case 7:\n                response = _context21.sent;\n                return _context21.abrupt(\"return\", response);\n\n              case 9:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21);\n      }));\n\n      function signAllTransactions(_x23) {\n        return _signAllTransactions2.apply(this, arguments);\n      }\n\n      return signAllTransactions;\n    }()\n  };\n  return providerHandlers;\n};\n\nfunction ownKeys$1(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys$1(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar TorusInjectedProvider = /*#__PURE__*/function (_BaseProvider2) {\n  _inherits(TorusInjectedProvider, _BaseProvider2);\n\n  var _super2 = _createSuper(TorusInjectedProvider);\n\n  function TorusInjectedProvider(_ref) {\n    _classCallCheck(this, TorusInjectedProvider);\n\n    var config = _ref.config,\n        state = _ref.state;\n    return _super2.call(this, {\n      config: {\n        chainConfig: _objectSpread$1(_objectSpread$1({}, config.chainConfig), {}, {\n          chainNamespace: CHAIN_NAMESPACES.SOLANA\n        })\n      },\n      state: state\n    });\n  }\n\n  _createClass(TorusInjectedProvider, [{\n    key: \"switchChain\",\n    value: function () {\n      var _switchChain2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee22(_) {\n        return _regeneratorRuntime().wrap(function _callee22$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                return _context22.abrupt(\"return\", Promise.resolve());\n\n              case 1:\n              case \"end\":\n                return _context22.stop();\n            }\n          }\n        }, _callee22);\n      }));\n\n      function switchChain(_x24) {\n        return _switchChain2.apply(this, arguments);\n      }\n\n      return switchChain;\n    }()\n  }, {\n    key: \"setupProvider\",\n    value: function () {\n      var _setupProvider2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee23(injectedProvider) {\n        return _regeneratorRuntime().wrap(function _callee23$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                this.handleInjectedProviderUpdate(injectedProvider);\n                _context23.next = 3;\n                return this.setupEngine(injectedProvider);\n\n              case 3:\n              case \"end\":\n                return _context23.stop();\n            }\n          }\n        }, _callee23, this);\n      }));\n\n      function setupProvider(_x25) {\n        return _setupProvider2.apply(this, arguments);\n      }\n\n      return setupProvider;\n    }()\n  }, {\n    key: \"lookupNetwork\",\n    value: function () {\n      var _lookupNetwork2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee24() {\n        var chainId, connectedChainId, connectedHexChainId;\n        return _regeneratorRuntime().wrap(function _callee24$(_context24) {\n          while (1) {\n            switch (_context24.prev = _context24.next) {\n              case 0:\n                if (this.provider) {\n                  _context24.next = 2;\n                  break;\n                }\n\n                throw ethErrors.provider.custom({\n                  message: \"Torus solana provider is not initialized\",\n                  code: 4902\n                });\n\n              case 2:\n                chainId = this.config.chainConfig.chainId;\n                _context24.next = 5;\n                return this.provider.request({\n                  method: \"solana_chainId\"\n                });\n\n              case 5:\n                connectedChainId = _context24.sent;\n                connectedHexChainId = isHexStrict(connectedChainId.toString()) ? connectedChainId : \"0x\".concat(parseInt(connectedChainId, 10).toString(16));\n\n                if (!(chainId !== connectedHexChainId)) {\n                  _context24.next = 9;\n                  break;\n                }\n\n                throw WalletInitializationError.rpcConnectionError(\"Invalid network, net_version is: \".concat(connectedHexChainId, \", expected: \").concat(chainId));\n\n              case 9:\n                this.update({\n                  chainId: connectedHexChainId\n                });\n                this.provider.emit(\"connect\", {\n                  chainId: this.state.chainId\n                });\n                this.provider.emit(\"chainChanged\", this.state.chainId);\n                return _context24.abrupt(\"return\", this.state.chainId);\n\n              case 13:\n              case \"end\":\n                return _context24.stop();\n            }\n          }\n        }, _callee24, this);\n      }));\n\n      function lookupNetwork() {\n        return _lookupNetwork2.apply(this, arguments);\n      }\n\n      return lookupNetwork;\n    }()\n  }, {\n    key: \"setupEngine\",\n    value: function () {\n      var _setupEngine = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee25(injectedProvider) {\n        var providerHandlers, solanaMiddleware, injectedProviderProxy, engine, provider;\n        return _regeneratorRuntime().wrap(function _callee25$(_context25) {\n          while (1) {\n            switch (_context25.prev = _context25.next) {\n              case 0:\n                providerHandlers = getTorusHandlers(injectedProvider);\n                solanaMiddleware = createSolanaMiddleware(providerHandlers);\n                injectedProviderProxy = createInjectedProviderProxyMiddleware(injectedProvider);\n                engine = new JRPCEngine();\n                engine.push(solanaMiddleware);\n                engine.push(injectedProviderProxy);\n                provider = providerFromEngine(engine);\n                this.updateProviderEngineProxy(provider);\n                _context25.next = 10;\n                return this.lookupNetwork();\n\n              case 10:\n              case \"end\":\n                return _context25.stop();\n            }\n          }\n        }, _callee25, this);\n      }));\n\n      function setupEngine(_x26) {\n        return _setupEngine.apply(this, arguments);\n      }\n\n      return setupEngine;\n    }()\n  }, {\n    key: \"handleInjectedProviderUpdate\",\n    value: function () {\n      var _handleInjectedProviderUpdate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee28(injectedProvider) {\n        var _this = this;\n\n        return _regeneratorRuntime().wrap(function _callee28$(_context28) {\n          while (1) {\n            switch (_context28.prev = _context28.next) {\n              case 0:\n                injectedProvider.on(\"accountsChanged\", /*#__PURE__*/function () {\n                  var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee26(accounts) {\n                    return _regeneratorRuntime().wrap(function _callee26$(_context26) {\n                      while (1) {\n                        switch (_context26.prev = _context26.next) {\n                          case 0:\n                            _this.provider.emit(\"accountsChanged\", accounts);\n\n                          case 1:\n                          case \"end\":\n                            return _context26.stop();\n                        }\n                      }\n                    }, _callee26);\n                  }));\n\n                  return function (_x28) {\n                    return _ref9.apply(this, arguments);\n                  };\n                }());\n                injectedProvider.on(\"chainChanged\", /*#__PURE__*/function () {\n                  var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee27(chainId) {\n                    var connectedHexChainId;\n                    return _regeneratorRuntime().wrap(function _callee27$(_context27) {\n                      while (1) {\n                        switch (_context27.prev = _context27.next) {\n                          case 0:\n                            connectedHexChainId = isHexStrict(chainId) ? chainId : \"0x\".concat(parseInt(chainId, 10).toString(16)); // Check if chainId changed and trigger event\n\n                            _this.configure({\n                              chainConfig: _objectSpread$1(_objectSpread$1({}, _this.config.chainConfig), {}, {\n                                chainId: connectedHexChainId\n                              })\n                            });\n\n                            _context27.next = 4;\n                            return _this.setupProvider(injectedProvider);\n\n                          case 4:\n                          case \"end\":\n                            return _context27.stop();\n                        }\n                      }\n                    }, _callee27);\n                  }));\n\n                  return function (_x29) {\n                    return _ref10.apply(this, arguments);\n                  };\n                }());\n\n              case 2:\n              case \"end\":\n                return _context28.stop();\n            }\n          }\n        }, _callee28);\n      }));\n\n      function handleInjectedProviderUpdate(_x27) {\n        return _handleInjectedProviderUpdate.apply(this, arguments);\n      }\n\n      return handleInjectedProviderUpdate;\n    }()\n  }]);\n\n  return TorusInjectedProvider;\n}(BaseProvider);\n\nfunction createChainIdMiddleware(chainId) {\n  return function (req, res, next, end) {\n    if (req.method === \"solana_chainId\") {\n      res.result = chainId;\n      return end();\n    }\n\n    return next();\n  };\n}\n\nfunction createProviderConfigMiddleware(providerConfig) {\n  return function (req, res, next, end) {\n    if (req.method === \"solana_provider_config\") {\n      res.result = providerConfig;\n      return end();\n    }\n\n    return next();\n  };\n}\n\nfunction createJsonRpcClient(providerConfig) {\n  var chainId = providerConfig.chainId,\n      rpcTarget = providerConfig.rpcTarget;\n  var fetchMiddleware = createFetchMiddleware({\n    rpcTarget: rpcTarget\n  });\n  var networkMiddleware = mergeMiddleware([createChainIdMiddleware(chainId), createProviderConfigMiddleware(providerConfig), fetchMiddleware]);\n  return {\n    networkMiddleware: networkMiddleware,\n    fetchMiddleware: fetchMiddleware\n  };\n}\n\nfunction getProviderHandlers(_x30) {\n  return _getProviderHandlers.apply(this, arguments);\n}\n\nfunction _getProviderHandlers() {\n  _getProviderHandlers = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee51(_ref) {\n    var privKey, getProviderEngineProxy, transactionGenerator, keyPairGenerator, keyPair, providerHandlers;\n    return _regeneratorRuntime().wrap(function _callee51$(_context51) {\n      while (1) {\n        switch (_context51.prev = _context51.next) {\n          case 0:\n            privKey = _ref.privKey, getProviderEngineProxy = _ref.getProviderEngineProxy;\n\n            transactionGenerator = function transactionGenerator(serializedTx) {\n              var decodedTx = bs58.decode(serializedTx);\n              var tx = Transaction.populate(Message.from(decodedTx));\n              return tx;\n            };\n\n            keyPairGenerator = function keyPairGenerator() {\n              return Keypair.fromSecretKey(Buffer.from(privKey, \"hex\"));\n            };\n\n            if (!(typeof privKey !== \"string\")) {\n              _context51.next = 5;\n              break;\n            }\n\n            throw WalletInitializationError.invalidParams(\"privKey must be a string\");\n\n          case 5:\n            keyPair = keyPairGenerator();\n            providerHandlers = {\n              requestAccounts: function () {\n                var _requestAccounts4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee44() {\n                  return _regeneratorRuntime().wrap(function _callee44$(_context44) {\n                    while (1) {\n                      switch (_context44.prev = _context44.next) {\n                        case 0:\n                          return _context44.abrupt(\"return\", [keyPair.publicKey.toBase58()]);\n\n                        case 1:\n                        case \"end\":\n                          return _context44.stop();\n                      }\n                    }\n                  }, _callee44);\n                }));\n\n                function requestAccounts() {\n                  return _requestAccounts4.apply(this, arguments);\n                }\n\n                return requestAccounts;\n              }(),\n              getAccounts: function () {\n                var _getAccounts3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee45() {\n                  return _regeneratorRuntime().wrap(function _callee45$(_context45) {\n                    while (1) {\n                      switch (_context45.prev = _context45.next) {\n                        case 0:\n                          return _context45.abrupt(\"return\", [keyPair.publicKey.toBase58()]);\n\n                        case 1:\n                        case \"end\":\n                          return _context45.stop();\n                      }\n                    }\n                  }, _callee45);\n                }));\n\n                function getAccounts() {\n                  return _getAccounts3.apply(this, arguments);\n                }\n\n                return getAccounts;\n              }(),\n              getPrivateKey: function () {\n                var _getPrivateKey3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee46() {\n                  return _regeneratorRuntime().wrap(function _callee46$(_context46) {\n                    while (1) {\n                      switch (_context46.prev = _context46.next) {\n                        case 0:\n                          return _context46.abrupt(\"return\", privKey);\n\n                        case 1:\n                        case \"end\":\n                          return _context46.stop();\n                      }\n                    }\n                  }, _callee46);\n                }));\n\n                function getPrivateKey() {\n                  return _getPrivateKey3.apply(this, arguments);\n                }\n\n                return getPrivateKey;\n              }(),\n              signTransaction: function () {\n                var _signTransaction4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee47(req) {\n                  var _req$params, _req$params2, transaction;\n\n                  return _regeneratorRuntime().wrap(function _callee47$(_context47) {\n                    while (1) {\n                      switch (_context47.prev = _context47.next) {\n                        case 0:\n                          if ((_req$params = req.params) !== null && _req$params !== void 0 && _req$params.message) {\n                            _context47.next = 2;\n                            break;\n                          }\n\n                          throw ethErrors.rpc.invalidParams(\"message\");\n\n                        case 2:\n                          transaction = transactionGenerator((_req$params2 = req.params) === null || _req$params2 === void 0 ? void 0 : _req$params2.message);\n                          transaction.partialSign(keyPair);\n                          return _context47.abrupt(\"return\", transaction);\n\n                        case 5:\n                        case \"end\":\n                          return _context47.stop();\n                      }\n                    }\n                  }, _callee47);\n                }));\n\n                function signTransaction(_x43) {\n                  return _signTransaction4.apply(this, arguments);\n                }\n\n                return signTransaction;\n              }(),\n              signMessage: function () {\n                var _signMessage4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee48(req) {\n                  var _req$params3, signedMsg;\n\n                  return _regeneratorRuntime().wrap(function _callee48$(_context48) {\n                    while (1) {\n                      switch (_context48.prev = _context48.next) {\n                        case 0:\n                          if ((_req$params3 = req.params) !== null && _req$params3 !== void 0 && _req$params3.message) {\n                            _context48.next = 2;\n                            break;\n                          }\n\n                          throw ethErrors.rpc.invalidParams(\"message\");\n\n                        case 2:\n                          signedMsg = nacl.sign.detached(req.params.message, keyPair.secretKey);\n                          return _context48.abrupt(\"return\", signedMsg);\n\n                        case 4:\n                        case \"end\":\n                          return _context48.stop();\n                      }\n                    }\n                  }, _callee48);\n                }));\n\n                function signMessage(_x44) {\n                  return _signMessage4.apply(this, arguments);\n                }\n\n                return signMessage;\n              }(),\n              signAndSendTransaction: function () {\n                var _signAndSendTransaction4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee49(req) {\n                  var _req$params4, _req$params5, _providerEngineProxy, transaction, sig;\n\n                  return _regeneratorRuntime().wrap(function _callee49$(_context49) {\n                    while (1) {\n                      switch (_context49.prev = _context49.next) {\n                        case 0:\n                          if ((_req$params4 = req.params) !== null && _req$params4 !== void 0 && _req$params4.message) {\n                            _context49.next = 2;\n                            break;\n                          }\n\n                          throw ethErrors.rpc.invalidParams(\"message\");\n\n                        case 2:\n                          _providerEngineProxy = getProviderEngineProxy();\n\n                          if (_providerEngineProxy) {\n                            _context49.next = 5;\n                            break;\n                          }\n\n                          throw ethErrors.provider.custom({\n                            message: \"Provider is not initialized\",\n                            code: 4902\n                          });\n\n                        case 5:\n                          transaction = transactionGenerator((_req$params5 = req.params) === null || _req$params5 === void 0 ? void 0 : _req$params5.message);\n                          transaction.sign(keyPair);\n                          _context49.next = 9;\n                          return _providerEngineProxy.request({\n                            method: \"sendTransaction\",\n                            params: [bs58.encode(transaction.serialize())]\n                          });\n\n                        case 9:\n                          sig = _context49.sent;\n                          return _context49.abrupt(\"return\", {\n                            signature: sig\n                          });\n\n                        case 11:\n                        case \"end\":\n                          return _context49.stop();\n                      }\n                    }\n                  }, _callee49);\n                }));\n\n                function signAndSendTransaction(_x45) {\n                  return _signAndSendTransaction4.apply(this, arguments);\n                }\n\n                return signAndSendTransaction;\n              }(),\n              signAllTransactions: function () {\n                var _signAllTransactions4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee50(req) {\n                  var _req$params6, _req$params7, signedTransactions, _iterator2, _step2, tx, _req$params8, transaction;\n\n                  return _regeneratorRuntime().wrap(function _callee50$(_context50) {\n                    while (1) {\n                      switch (_context50.prev = _context50.next) {\n                        case 0:\n                          if (!(!((_req$params6 = req.params) !== null && _req$params6 !== void 0 && _req$params6.message) || !((_req$params7 = req.params) !== null && _req$params7 !== void 0 && _req$params7.message.length))) {\n                            _context50.next = 2;\n                            break;\n                          }\n\n                          throw ethErrors.rpc.invalidParams(\"message\");\n\n                        case 2:\n                          signedTransactions = [];\n                          _iterator2 = _createForOfIteratorHelper(((_req$params8 = req.params) === null || _req$params8 === void 0 ? void 0 : _req$params8.message) || []);\n\n                          try {\n                            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                              tx = _step2.value;\n                              transaction = transactionGenerator(tx);\n                              transaction.partialSign(keyPair);\n                              signedTransactions.push(transaction);\n                            }\n                          } catch (err) {\n                            _iterator2.e(err);\n                          } finally {\n                            _iterator2.f();\n                          }\n\n                          return _context50.abrupt(\"return\", signedTransactions);\n\n                        case 6:\n                        case \"end\":\n                          return _context50.stop();\n                      }\n                    }\n                  }, _callee50);\n                }));\n\n                function signAllTransactions(_x46) {\n                  return _signAllTransactions4.apply(this, arguments);\n                }\n\n                return signAllTransactions;\n              }()\n            };\n            return _context51.abrupt(\"return\", providerHandlers);\n\n          case 8:\n          case \"end\":\n            return _context51.stop();\n        }\n      }\n    }, _callee51);\n  }));\n  return _getProviderHandlers.apply(this, arguments);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar SolanaPrivateKeyProvider = /*#__PURE__*/function (_BaseProvider3) {\n  _inherits(SolanaPrivateKeyProvider, _BaseProvider3);\n\n  var _super3 = _createSuper(SolanaPrivateKeyProvider);\n\n  function SolanaPrivateKeyProvider(_ref) {\n    _classCallCheck(this, SolanaPrivateKeyProvider);\n\n    var config = _ref.config,\n        state = _ref.state;\n    return _super3.call(this, {\n      config: {\n        chainConfig: _objectSpread(_objectSpread({}, config.chainConfig), {}, {\n          chainNamespace: CHAIN_NAMESPACES.SOLANA\n        })\n      },\n      state: state\n    });\n  }\n\n  _createClass(SolanaPrivateKeyProvider, [{\n    key: \"enable\",\n    value: function () {\n      var _enable = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee29() {\n        return _regeneratorRuntime().wrap(function _callee29$(_context29) {\n          while (1) {\n            switch (_context29.prev = _context29.next) {\n              case 0:\n                if (this.state.privateKey) {\n                  _context29.next = 2;\n                  break;\n                }\n\n                throw ethErrors.provider.custom({\n                  message: \"Private key is not found in state, plz pass it in constructor state param\",\n                  code: 4902\n                });\n\n              case 2:\n                _context29.next = 4;\n                return this.setupProvider(this.state.privateKey);\n\n              case 4:\n                return _context29.abrupt(\"return\", this._providerEngineProxy.request({\n                  method: \"eth_accounts\"\n                }));\n\n              case 5:\n              case \"end\":\n                return _context29.stop();\n            }\n          }\n        }, _callee29, this);\n      }));\n\n      function enable() {\n        return _enable.apply(this, arguments);\n      }\n\n      return enable;\n    }()\n  }, {\n    key: \"setupProvider\",\n    value: function () {\n      var _setupProvider3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee30(privKey) {\n        var providerHandlers, solanaMiddleware, engine, _createJsonRpcClient, networkMiddleware, provider;\n\n        return _regeneratorRuntime().wrap(function _callee30$(_context30) {\n          while (1) {\n            switch (_context30.prev = _context30.next) {\n              case 0:\n                _context30.next = 2;\n                return getProviderHandlers({\n                  privKey: privKey,\n                  getProviderEngineProxy: this.getProviderEngineProxy.bind(this)\n                });\n\n              case 2:\n                providerHandlers = _context30.sent;\n                solanaMiddleware = createSolanaMiddleware(providerHandlers);\n                engine = new JRPCEngine();\n                _createJsonRpcClient = createJsonRpcClient(this.config.chainConfig), networkMiddleware = _createJsonRpcClient.networkMiddleware;\n                engine.push(this.getChainSwitchMiddleware());\n                engine.push(this.getAccountMiddleware());\n                engine.push(solanaMiddleware);\n                engine.push(networkMiddleware);\n                provider = providerFromEngine(engine);\n                this.updateProviderEngineProxy(provider);\n                _context30.next = 14;\n                return this.lookupNetwork();\n\n              case 14:\n              case \"end\":\n                return _context30.stop();\n            }\n          }\n        }, _callee30, this);\n      }));\n\n      function setupProvider(_x31) {\n        return _setupProvider3.apply(this, arguments);\n      }\n\n      return setupProvider;\n    }()\n  }, {\n    key: \"updateAccount\",\n    value: function () {\n      var _updateAccount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee31(params) {\n        var existingKey;\n        return _regeneratorRuntime().wrap(function _callee31$(_context31) {\n          while (1) {\n            switch (_context31.prev = _context31.next) {\n              case 0:\n                if (this._providerEngineProxy) {\n                  _context31.next = 2;\n                  break;\n                }\n\n                throw ethErrors.provider.custom({\n                  message: \"Provider is not initialized\",\n                  code: 4902\n                });\n\n              case 2:\n                _context31.next = 4;\n                return this._providerEngineProxy.request({\n                  method: \"solanaPrivateKey\"\n                });\n\n              case 4:\n                existingKey = _context31.sent;\n\n                if (!(existingKey !== params.privateKey)) {\n                  _context31.next = 14;\n                  break;\n                }\n\n                _context31.next = 8;\n                return this.setupProvider(params.privateKey);\n\n              case 8:\n                _context31.t0 = this._providerEngineProxy;\n                _context31.next = 11;\n                return this._providerEngineProxy.request({\n                  method: \"requestAccounts\"\n                });\n\n              case 11:\n                _context31.t1 = _context31.sent;\n                _context31.t2 = {\n                  accounts: _context31.t1\n                };\n\n                _context31.t0.emit.call(_context31.t0, \"accountsChanged\", _context31.t2);\n\n              case 14:\n              case \"end\":\n                return _context31.stop();\n            }\n          }\n        }, _callee31, this);\n      }));\n\n      function updateAccount(_x32) {\n        return _updateAccount.apply(this, arguments);\n      }\n\n      return updateAccount;\n    }()\n  }, {\n    key: \"switchChain\",\n    value: function () {\n      var _switchChain3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee32(params) {\n        var chainConfig, privKey;\n        return _regeneratorRuntime().wrap(function _callee32$(_context32) {\n          while (1) {\n            switch (_context32.prev = _context32.next) {\n              case 0:\n                if (this._providerEngineProxy) {\n                  _context32.next = 2;\n                  break;\n                }\n\n                throw ethErrors.provider.custom({\n                  message: \"Provider is not initialized\",\n                  code: 4902\n                });\n\n              case 2:\n                chainConfig = this.getChainConfig(params.chainId);\n                this.update({\n                  chainId: \"loading\"\n                });\n                this.configure({\n                  chainConfig: chainConfig\n                });\n                _context32.next = 7;\n                return this._providerEngineProxy.request({\n                  method: \"solanaPrivateKey\"\n                });\n\n              case 7:\n                privKey = _context32.sent;\n                _context32.next = 10;\n                return this.setupProvider(privKey);\n\n              case 10:\n              case \"end\":\n                return _context32.stop();\n            }\n          }\n        }, _callee32, this);\n      }));\n\n      function switchChain(_x33) {\n        return _switchChain3.apply(this, arguments);\n      }\n\n      return switchChain;\n    }()\n  }, {\n    key: \"lookupNetwork\",\n    value: function () {\n      var _lookupNetwork3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee33() {\n        var health, chainConfig;\n        return _regeneratorRuntime().wrap(function _callee33$(_context33) {\n          while (1) {\n            switch (_context33.prev = _context33.next) {\n              case 0:\n                if (this._providerEngineProxy) {\n                  _context33.next = 2;\n                  break;\n                }\n\n                throw ethErrors.provider.custom({\n                  message: \"Provider is not initialized\",\n                  code: 4902\n                });\n\n              case 2:\n                _context33.next = 4;\n                return this._providerEngineProxy.request({\n                  method: \"getHealth\",\n                  params: []\n                });\n\n              case 4:\n                health = _context33.sent;\n                chainConfig = this.config.chainConfig;\n\n                if (!(health !== \"ok\")) {\n                  _context33.next = 8;\n                  break;\n                }\n\n                throw WalletInitializationError.rpcConnectionError(\"Failed to lookup network for following rpc target: \".concat(chainConfig.rpcTarget));\n\n              case 8:\n                this.update({\n                  chainId: chainConfig.chainId\n                });\n\n                if (this.state.chainId !== chainConfig.chainId) {\n                  this.provider.emit(\"chainChanged\", this.state.chainId);\n                  this.provider.emit(\"connect\", {\n                    chainId: this.state.chainId\n                  });\n                }\n\n                return _context33.abrupt(\"return\", this.state.chainId);\n\n              case 11:\n              case \"end\":\n                return _context33.stop();\n            }\n          }\n        }, _callee33, this);\n      }));\n\n      function lookupNetwork() {\n        return _lookupNetwork3.apply(this, arguments);\n      }\n\n      return lookupNetwork;\n    }()\n  }, {\n    key: \"getChainSwitchMiddleware\",\n    value: function getChainSwitchMiddleware() {\n      var _this2 = this;\n\n      var chainSwitchHandlers = {\n        addNewChainConfig: function () {\n          var _addNewChainConfig = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee34(req) {\n            var _req$params9, chainId, chainName, rpcUrls, blockExplorerUrls, nativeCurrency;\n\n            return _regeneratorRuntime().wrap(function _callee34$(_context34) {\n              while (1) {\n                switch (_context34.prev = _context34.next) {\n                  case 0:\n                    if (req.params) {\n                      _context34.next = 2;\n                      break;\n                    }\n\n                    throw ethErrors.rpc.invalidParams(\"Missing request params\");\n\n                  case 2:\n                    _req$params9 = req.params, chainId = _req$params9.chainId, chainName = _req$params9.chainName, rpcUrls = _req$params9.rpcUrls, blockExplorerUrls = _req$params9.blockExplorerUrls, nativeCurrency = _req$params9.nativeCurrency;\n\n                    if (chainId) {\n                      _context34.next = 5;\n                      break;\n                    }\n\n                    throw ethErrors.rpc.invalidParams(\"Missing chainId in chainParams\");\n\n                  case 5:\n                    if (!(!rpcUrls || rpcUrls.length === 0)) {\n                      _context34.next = 7;\n                      break;\n                    }\n\n                    throw ethErrors.rpc.invalidParams(\"Missing rpcUrls in chainParams\");\n\n                  case 7:\n                    if (nativeCurrency) {\n                      _context34.next = 9;\n                      break;\n                    }\n\n                    throw ethErrors.rpc.invalidParams(\"Missing nativeCurrency in chainParams\");\n\n                  case 9:\n                    _this2.addChain({\n                      chainNamespace: CHAIN_NAMESPACES.SOLANA,\n                      chainId: chainId,\n                      ticker: (nativeCurrency === null || nativeCurrency === void 0 ? void 0 : nativeCurrency.symbol) || \"SOL\",\n                      tickerName: (nativeCurrency === null || nativeCurrency === void 0 ? void 0 : nativeCurrency.name) || \"Solana\",\n                      displayName: chainName,\n                      rpcTarget: rpcUrls[0],\n                      blockExplorer: (blockExplorerUrls === null || blockExplorerUrls === void 0 ? void 0 : blockExplorerUrls[0]) || \"\"\n                    });\n\n                  case 10:\n                  case \"end\":\n                    return _context34.stop();\n                }\n              }\n            }, _callee34);\n          }));\n\n          function addNewChainConfig(_x34) {\n            return _addNewChainConfig.apply(this, arguments);\n          }\n\n          return addNewChainConfig;\n        }(),\n        switchSolanaChain: function () {\n          var _switchSolanaChain = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee35(req) {\n            return _regeneratorRuntime().wrap(function _callee35$(_context35) {\n              while (1) {\n                switch (_context35.prev = _context35.next) {\n                  case 0:\n                    if (req.params) {\n                      _context35.next = 2;\n                      break;\n                    }\n\n                    throw ethErrors.rpc.invalidParams(\"Missing request params\");\n\n                  case 2:\n                    if (req.params.chainId) {\n                      _context35.next = 4;\n                      break;\n                    }\n\n                    throw ethErrors.rpc.invalidParams(\"Missing chainId\");\n\n                  case 4:\n                    _context35.next = 6;\n                    return _this2.switchChain(req.params);\n\n                  case 6:\n                  case \"end\":\n                    return _context35.stop();\n                }\n              }\n            }, _callee35);\n          }));\n\n          function switchSolanaChain(_x35) {\n            return _switchSolanaChain.apply(this, arguments);\n          }\n\n          return switchSolanaChain;\n        }()\n      };\n      var chainSwitchMiddleware = createChainSwitchMiddleware(chainSwitchHandlers);\n      return chainSwitchMiddleware;\n    }\n  }, {\n    key: \"getAccountMiddleware\",\n    value: function getAccountMiddleware() {\n      var _this3 = this;\n\n      var accountHandlers = {\n        updatePrivatekey: function () {\n          var _updatePrivatekey = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee36(req) {\n            var privateKey;\n            return _regeneratorRuntime().wrap(function _callee36$(_context36) {\n              while (1) {\n                switch (_context36.prev = _context36.next) {\n                  case 0:\n                    if (req.params) {\n                      _context36.next = 2;\n                      break;\n                    }\n\n                    throw ethErrors.rpc.invalidParams(\"Missing request params\");\n\n                  case 2:\n                    if (req.params.privateKey) {\n                      _context36.next = 4;\n                      break;\n                    }\n\n                    throw ethErrors.rpc.invalidParams(\"Missing privateKey\");\n\n                  case 4:\n                    privateKey = req.params.privateKey;\n                    _context36.next = 7;\n                    return _this3.updateAccount({\n                      privateKey: privateKey\n                    });\n\n                  case 7:\n                  case \"end\":\n                    return _context36.stop();\n                }\n              }\n            }, _callee36);\n          }));\n\n          function updatePrivatekey(_x36) {\n            return _updatePrivatekey.apply(this, arguments);\n          }\n\n          return updatePrivatekey;\n        }()\n      };\n      return createAccountMiddleware(accountHandlers);\n    }\n  }]);\n\n  return SolanaPrivateKeyProvider;\n}(BaseProvider);\n\n_defineProperty(SolanaPrivateKeyProvider, \"getProviderInstance\", /*#__PURE__*/function () {\n  var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee37(params) {\n    var providerFactory;\n    return _regeneratorRuntime().wrap(function _callee37$(_context37) {\n      while (1) {\n        switch (_context37.prev = _context37.next) {\n          case 0:\n            providerFactory = new SolanaPrivateKeyProvider({\n              config: {\n                chainConfig: params.chainConfig\n              }\n            });\n            _context37.next = 3;\n            return providerFactory.setupProvider(params.privKey);\n\n          case 3:\n            return _context37.abrupt(\"return\", providerFactory);\n\n          case 4:\n          case \"end\":\n            return _context37.stop();\n        }\n      }\n    }, _callee37);\n  }));\n\n  return function (_x37) {\n    return _ref11.apply(this, arguments);\n  };\n}());\n\nvar SolanaWallet = /*#__PURE__*/function () {\n  function SolanaWallet(provider) {\n    _classCallCheck(this, SolanaWallet);\n\n    _defineProperty(this, \"provider\", void 0);\n\n    this.provider = provider;\n  }\n\n  _createClass(SolanaWallet, [{\n    key: \"requestAccounts\",\n    value: function () {\n      var _requestAccounts3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee38() {\n        var accounts;\n        return _regeneratorRuntime().wrap(function _callee38$(_context38) {\n          while (1) {\n            switch (_context38.prev = _context38.next) {\n              case 0:\n                _context38.next = 2;\n                return this.provider.request({\n                  method: \"requestAccounts\",\n                  params: {}\n                });\n\n              case 2:\n                accounts = _context38.sent;\n                return _context38.abrupt(\"return\", accounts);\n\n              case 4:\n              case \"end\":\n                return _context38.stop();\n            }\n          }\n        }, _callee38, this);\n      }));\n\n      function requestAccounts() {\n        return _requestAccounts3.apply(this, arguments);\n      }\n\n      return requestAccounts;\n    }()\n  }, {\n    key: \"signAndSendTransaction\",\n    value: function () {\n      var _signAndSendTransaction3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee39(transaction) {\n        var _yield$this$provider$, signature;\n\n        return _regeneratorRuntime().wrap(function _callee39$(_context39) {\n          while (1) {\n            switch (_context39.prev = _context39.next) {\n              case 0:\n                _context39.next = 2;\n                return this.provider.request({\n                  method: \"signAndSendTransaction\",\n                  params: {\n                    message: bs58.encode(transaction.serialize({\n                      requireAllSignatures: false\n                    }))\n                  }\n                });\n\n              case 2:\n                _yield$this$provider$ = _context39.sent;\n                signature = _yield$this$provider$.signature;\n                return _context39.abrupt(\"return\", {\n                  signature: signature\n                });\n\n              case 5:\n              case \"end\":\n                return _context39.stop();\n            }\n          }\n        }, _callee39, this);\n      }));\n\n      function signAndSendTransaction(_x38) {\n        return _signAndSendTransaction3.apply(this, arguments);\n      }\n\n      return signAndSendTransaction;\n    }()\n  }, {\n    key: \"signTransaction\",\n    value: function () {\n      var _signTransaction3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee40(transaction) {\n        var signedTransaction;\n        return _regeneratorRuntime().wrap(function _callee40$(_context40) {\n          while (1) {\n            switch (_context40.prev = _context40.next) {\n              case 0:\n                _context40.next = 2;\n                return this.provider.request({\n                  method: \"signTransaction\",\n                  params: {\n                    message: bs58.encode(transaction.serialize({\n                      requireAllSignatures: false\n                    }))\n                  }\n                });\n\n              case 2:\n                signedTransaction = _context40.sent;\n                return _context40.abrupt(\"return\", signedTransaction);\n\n              case 4:\n              case \"end\":\n                return _context40.stop();\n            }\n          }\n        }, _callee40, this);\n      }));\n\n      function signTransaction(_x39) {\n        return _signTransaction3.apply(this, arguments);\n      }\n\n      return signTransaction;\n    }()\n  }, {\n    key: \"signAllTransactions\",\n    value: function () {\n      var _signAllTransactions3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee41(transactions) {\n        var messages, signedTransaction;\n        return _regeneratorRuntime().wrap(function _callee41$(_context41) {\n          while (1) {\n            switch (_context41.prev = _context41.next) {\n              case 0:\n                messages = transactions.map(function (transaction) {\n                  return bs58.encode(transaction.serialize({\n                    requireAllSignatures: false\n                  }));\n                });\n                _context41.next = 3;\n                return this.provider.request({\n                  method: \"signAllTransactions\",\n                  params: {\n                    message: messages\n                  }\n                });\n\n              case 3:\n                signedTransaction = _context41.sent;\n                return _context41.abrupt(\"return\", signedTransaction);\n\n              case 5:\n              case \"end\":\n                return _context41.stop();\n            }\n          }\n        }, _callee41, this);\n      }));\n\n      function signAllTransactions(_x40) {\n        return _signAllTransactions3.apply(this, arguments);\n      }\n\n      return signAllTransactions;\n    }()\n  }, {\n    key: \"signMessage\",\n    value: function () {\n      var _signMessage3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee42(data) {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee42$(_context42) {\n          while (1) {\n            switch (_context42.prev = _context42.next) {\n              case 0:\n                _context42.next = 2;\n                return this.provider.request({\n                  method: \"signMessage\",\n                  params: {\n                    message: data\n                  }\n                });\n\n              case 2:\n                response = _context42.sent;\n                return _context42.abrupt(\"return\", response);\n\n              case 4:\n              case \"end\":\n                return _context42.stop();\n            }\n          }\n        }, _callee42, this);\n      }));\n\n      function signMessage(_x41) {\n        return _signMessage3.apply(this, arguments);\n      }\n\n      return signMessage;\n    }()\n  }, {\n    key: \"request\",\n    value: function () {\n      var _request = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee43(args) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee43$(_context43) {\n          while (1) {\n            switch (_context43.prev = _context43.next) {\n              case 0:\n                _context43.next = 2;\n                return this.provider.request(args);\n\n              case 2:\n                result = _context43.sent;\n                return _context43.abrupt(\"return\", result);\n\n              case 4:\n              case \"end\":\n                return _context43.stop();\n            }\n          }\n        }, _callee43, this);\n      }));\n\n      function request(_x42) {\n        return _request.apply(this, arguments);\n      }\n\n      return request;\n    }()\n  }]);\n\n  return SolanaWallet;\n}();\n\nexport { PhantomInjectedProvider, SolanaPrivateKeyProvider, SolanaWallet, TorusInjectedProvider };","map":{"version":3,"sources":["../src/rpc/solanaRpcMiddlewares.ts","../src/providers/injectedProviders/injectedProviderProxy.ts","../src/providers/injectedProviders/phantom/providerHandlers.ts","../src/providers/injectedProviders/phantom/phantomInjectedProvider.ts","../src/providers/injectedProviders/torus/providerHandlers.ts","../src/providers/injectedProviders/torus/torusInjectedProvider.ts","../src/rpc/JrpcClient.ts","../src/providers/privateKeyProvider/solanaPrivateKeyUtils.ts","../src/providers/privateKeyProvider/solanaPrivateKeyProvider.ts","../src/solanaWallet.ts"],"names":["createGetAccountsMiddleware","getAccounts","createAsyncMiddleware","method","next","accounts","response","createRequestAccountsMiddleware","requestAccounts","createGenericJRPCMiddleware","targetMethod","handler","result","createSolanaMiddleware","providerHandlers","getPrivateKey","mergeMiddleware","createChainSwitchMiddleware","switchSolanaChain","createAccountMiddleware","updatePrivatekey","createInjectedProviderProxyMiddleware","provider","res","getPhantomHandlers","injectedProvider","bs58","ethErrors","signTransaction","message","req","txn","Transaction","transaction","signMessage","params","signAndSendTransaction","txRes","signature","signAllTransactions","txns","msg","decodedMsg","PhantomInjectedProvider","BaseProvider","constructor","state","config","chainConfig","chainNamespace","CHAIN_NAMESPACES","SOLANA","switchChain","Promise","setupProvider","solanaMiddleware","injectedProviderProxy","engine","providerFromEngine","lookupNetwork","chainId","getTorusHandlers","data","buf","Buffer","sendTx","messages","TorusInjectedProvider","code","connectedChainId","connectedHexChainId","isHexStrict","parseInt","WalletInitializationError","setupEngine","handleInjectedProviderUpdate","createChainIdMiddleware","end","createProviderConfigMiddleware","providerConfig","createJsonRpcClient","rpcTarget","fetchMiddleware","createFetchMiddleware","networkMiddleware","getProviderEngineProxy","transactionGenerator","serializedTx","decodedTx","tx","Message","keyPairGenerator","Keypair","keyPair","signedMsg","nacl","_providerEngineProxy","sig","signedTransactions","SolanaPrivateKeyProvider","providerFactory","enable","getProviderHandlers","privKey","updateAccount","existingKey","health","getChainSwitchMiddleware","chainSwitchHandlers","addNewChainConfig","nativeCurrency","rpcUrls","ticker","tickerName","displayName","blockExplorer","chainSwitchMiddleware","getAccountMiddleware","accountHandlers","privateKey","SolanaWallet","requireAllSignatures","signedTransaction","request"],"mappings":"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","sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { providerFromEngine, createFetchMiddleware } from '@toruslabs/base-controllers';\nimport { mergeMiddleware, createAsyncMiddleware, JRPCEngine } from '@toruslabs/openlogin-jrpc';\nimport { CHAIN_NAMESPACES, isHexStrict, WalletInitializationError } from '@web3auth/base';\nimport { BaseProvider } from '@web3auth/base-provider';\nimport { Transaction, Keypair, Message } from '@solana/web3.js';\nimport bs58 from 'bs58';\nimport { ethErrors } from 'eth-rpc-errors';\nimport nacl from '@toruslabs/tweetnacl-js';\n\nfunction createGetAccountsMiddleware(_ref) {\n  let {\n    getAccounts\n  } = _ref;\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== \"getAccounts\") return next();\n    if (!getAccounts) throw new Error(\"WalletMiddleware - opts.getAccounts not provided\"); // This calls from the prefs controller\n\n    const accounts = await getAccounts(request);\n    response.result = accounts;\n    return undefined;\n  });\n}\nfunction createRequestAccountsMiddleware(_ref2) {\n  let {\n    requestAccounts\n  } = _ref2;\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== \"requestAccounts\") return next();\n    if (!requestAccounts) throw new Error(\"WalletMiddleware - opts.requestAccounts not provided\"); // This calls the UI login function\n\n    const accounts = await requestAccounts(request);\n    response.result = accounts;\n    return undefined;\n  });\n}\nfunction createGenericJRPCMiddleware(targetMethod, handler) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== targetMethod) return next();\n    if (!handler) throw new Error(\"WalletMiddleware - \".concat(targetMethod, \" not provided\"));\n    const result = await handler(request);\n    response.result = result;\n    return undefined;\n  });\n}\nfunction createSolanaMiddleware(providerHandlers) {\n  const {\n    getAccounts,\n    requestAccounts,\n    signTransaction,\n    signAndSendTransaction,\n    signAllTransactions,\n    signMessage,\n    getPrivateKey\n  } = providerHandlers;\n  return mergeMiddleware([createRequestAccountsMiddleware({\n    requestAccounts\n  }), createGetAccountsMiddleware({\n    getAccounts\n  }), createGenericJRPCMiddleware(\"signTransaction\", signTransaction), createGenericJRPCMiddleware(\"signAndSendTransaction\", signAndSendTransaction), createGenericJRPCMiddleware(\"signAllTransactions\", signAllTransactions), createGenericJRPCMiddleware(\"signMessage\", signMessage), createGenericJRPCMiddleware(\"solanaPrivateKey\", getPrivateKey)]);\n}\nfunction createChainSwitchMiddleware(_ref3) {\n  let {\n    addNewChainConfig,\n    switchSolanaChain\n  } = _ref3;\n  return mergeMiddleware([createGenericJRPCMiddleware(\"addSolanaChain\", addNewChainConfig), createGenericJRPCMiddleware(\"switchSolanaChain\", switchSolanaChain)]);\n}\nfunction createAccountMiddleware(_ref4) {\n  let {\n    updatePrivatekey\n  } = _ref4;\n  return mergeMiddleware([createGenericJRPCMiddleware(\"updateAccount\", updatePrivatekey)]);\n}\n\nfunction ownKeys$3(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$3(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys$3(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$3(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction createInjectedProviderProxyMiddleware(provider) {\n  return createAsyncMiddleware(async (req, res, _next) => {\n    const result = await provider.request(_objectSpread$3({}, req));\n    res.result = result;\n  });\n}\n\nconst getPhantomHandlers = injectedProvider => {\n  const providerHandlers = {\n    requestAccounts: async () => {\n      return injectedProvider.publicKey ? [bs58.encode(injectedProvider.publicKey.toBytes())] : [];\n    },\n    getAccounts: async () => injectedProvider.publicKey ? [bs58.encode(injectedProvider.publicKey.toBytes())] : [],\n    getPrivateKey: async () => {\n      throw ethErrors.rpc.methodNotSupported();\n    },\n    signTransaction: async req => {\n      const message = bs58.decode(req.params.message);\n      const txn = Transaction.from(message);\n      const transaction = await injectedProvider.signTransaction(txn);\n      return transaction;\n    },\n    signMessage: async req => {\n      var _req$params;\n\n      const message = await injectedProvider.request({\n        method: \"signMessage\",\n        params: {\n          message: (_req$params = req.params) === null || _req$params === void 0 ? void 0 : _req$params.message\n        }\n      });\n      return message;\n    },\n    signAndSendTransaction: async req => {\n      const message = bs58.decode(req.params.message);\n      const txn = Transaction.from(message);\n      const txRes = await injectedProvider.signAndSendTransaction(txn);\n      return {\n        signature: txRes.signature\n      };\n    },\n    signAllTransactions: async req => {\n      var _req$params2, _req$params3;\n\n      if (!((_req$params2 = req.params) !== null && _req$params2 !== void 0 && _req$params2.message) || !((_req$params3 = req.params) !== null && _req$params3 !== void 0 && _req$params3.message.length)) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n\n      const txns = req.params.message.map(msg => {\n        const decodedMsg = bs58.decode(msg);\n        return Transaction.from(decodedMsg);\n      });\n      const transaction = await injectedProvider.signAllTransactions(txns);\n      return transaction;\n    }\n  };\n  return providerHandlers;\n};\n\nfunction ownKeys$2(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$2(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys$2(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$2(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nclass PhantomInjectedProvider extends BaseProvider {\n  constructor(_ref) {\n    let {\n      config,\n      state\n    } = _ref;\n    super({\n      config: {\n        chainConfig: _objectSpread$2(_objectSpread$2({}, config.chainConfig), {}, {\n          chainNamespace: CHAIN_NAMESPACES.SOLANA\n        })\n      },\n      state\n    });\n  }\n\n  async switchChain(_) {\n    return Promise.resolve();\n  }\n\n  async setupProvider(injectedProvider) {\n    const providerHandlers = getPhantomHandlers(injectedProvider);\n    const solanaMiddleware = createSolanaMiddleware(providerHandlers);\n    const injectedProviderProxy = createInjectedProviderProxyMiddleware(injectedProvider);\n    const engine = new JRPCEngine();\n    engine.push(solanaMiddleware);\n    engine.push(injectedProviderProxy);\n    const provider = providerFromEngine(engine);\n    this.updateProviderEngineProxy(provider);\n    await this.lookupNetwork(injectedProvider);\n  }\n\n  async lookupNetwork(_) {\n    const {\n      chainConfig\n    } = this.config;\n    this.update({\n      chainId: chainConfig.chainId\n    });\n    return chainConfig.chainId || \"\"; // const genesisHash = await phantomProvider.request<string>({\n    //   method: \"getGenesisHash\",\n    //   params: [],\n    // });\n    // const { chainConfig } = this.config;\n    // if (!genesisHash) throw WalletInitializationError.rpcConnectionError(`Failed to connect with phantom wallet`);\n    // if (chainConfig.chainId !== genesisHash.substring(0, 32))\n    //   throw WalletInitializationError.invalidNetwork(\n    //     `Wallet is connected to wrong network,Please change your network to ${\n    //       SOLANA_NETWORKS[chainConfig.chainId] || chainConfig.displayName\n    //     } from phantom wallet extention.`\n    //   );\n    // return genesisHash.substring(0, 32);\n  }\n\n}\n\nconst getTorusHandlers = injectedProvider => {\n  const providerHandlers = {\n    requestAccounts: async () => {\n      const accounts = await injectedProvider.request({\n        method: \"solana_requestAccounts\",\n        params: {}\n      });\n      return accounts;\n    },\n    getAccounts: async () => {\n      const accounts = await injectedProvider.request({\n        method: \"solana_accounts\",\n        params: {}\n      });\n      return accounts;\n    },\n    getPrivateKey: async () => {\n      throw ethErrors.rpc.methodNotSupported();\n    },\n    signMessage: async req => {\n      var _req$params;\n\n      const message = await injectedProvider.request({\n        method: \"sign_message\",\n        params: {\n          data: (_req$params = req.params) === null || _req$params === void 0 ? void 0 : _req$params.message\n        }\n      });\n      return message;\n    },\n    signTransaction: async req => {\n      var _req$params2;\n\n      if (!((_req$params2 = req.params) !== null && _req$params2 !== void 0 && _req$params2.message)) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n\n      const message = bs58.decode(req.params.message).toString(\"hex\");\n      const response = await injectedProvider.request({\n        method: \"sign_transaction\",\n        params: {\n          message\n        }\n      });\n      const buf = Buffer.from(response, \"hex\");\n      const sendTx = Transaction.from(buf);\n      return sendTx;\n    },\n    signAndSendTransaction: async req => {\n      var _req$params3;\n\n      if (!((_req$params3 = req.params) !== null && _req$params3 !== void 0 && _req$params3.message)) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n\n      const message = bs58.decode(req.params.message).toString(\"hex\");\n      const response = await injectedProvider.request({\n        method: \"send_transaction\",\n        params: {\n          message\n        }\n      });\n      return {\n        signature: response\n      };\n    },\n    signAllTransactions: async req => {\n      var _req$params4, _req$params5;\n\n      if (!((_req$params4 = req.params) !== null && _req$params4 !== void 0 && _req$params4.message) || !((_req$params5 = req.params) !== null && _req$params5 !== void 0 && _req$params5.message.length)) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n\n      const messages = [];\n\n      for (const transaction of req.params.message) {\n        const message = bs58.decode(transaction).toString(\"hex\");\n        messages.push(message);\n      }\n\n      const response = await injectedProvider.request({\n        method: \"sign_all_transactions\",\n        params: {\n          message: messages\n        }\n      });\n      return response;\n    }\n  };\n  return providerHandlers;\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys$1(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nclass TorusInjectedProvider extends BaseProvider {\n  constructor(_ref) {\n    let {\n      config,\n      state\n    } = _ref;\n    super({\n      config: {\n        chainConfig: _objectSpread$1(_objectSpread$1({}, config.chainConfig), {}, {\n          chainNamespace: CHAIN_NAMESPACES.SOLANA\n        })\n      },\n      state\n    });\n  }\n\n  async switchChain(_) {\n    return Promise.resolve();\n  }\n\n  async setupProvider(injectedProvider) {\n    this.handleInjectedProviderUpdate(injectedProvider);\n    await this.setupEngine(injectedProvider);\n  }\n\n  async lookupNetwork() {\n    if (!this.provider) throw ethErrors.provider.custom({\n      message: \"Torus solana provider is not initialized\",\n      code: 4902\n    });\n    const {\n      chainId\n    } = this.config.chainConfig;\n    const connectedChainId = await this.provider.request({\n      method: \"solana_chainId\"\n    });\n    const connectedHexChainId = isHexStrict(connectedChainId.toString()) ? connectedChainId : \"0x\".concat(parseInt(connectedChainId, 10).toString(16));\n    if (chainId !== connectedHexChainId) throw WalletInitializationError.rpcConnectionError(\"Invalid network, net_version is: \".concat(connectedHexChainId, \", expected: \").concat(chainId));\n    this.update({\n      chainId: connectedHexChainId\n    });\n    this.provider.emit(\"connect\", {\n      chainId: this.state.chainId\n    });\n    this.provider.emit(\"chainChanged\", this.state.chainId);\n    return this.state.chainId;\n  }\n\n  async setupEngine(injectedProvider) {\n    const providerHandlers = getTorusHandlers(injectedProvider);\n    const solanaMiddleware = createSolanaMiddleware(providerHandlers);\n    const injectedProviderProxy = createInjectedProviderProxyMiddleware(injectedProvider);\n    const engine = new JRPCEngine();\n    engine.push(solanaMiddleware);\n    engine.push(injectedProviderProxy);\n    const provider = providerFromEngine(engine);\n    this.updateProviderEngineProxy(provider);\n    await this.lookupNetwork();\n  }\n\n  async handleInjectedProviderUpdate(injectedProvider) {\n    injectedProvider.on(\"accountsChanged\", async accounts => {\n      this.provider.emit(\"accountsChanged\", accounts);\n    });\n    injectedProvider.on(\"chainChanged\", async chainId => {\n      const connectedHexChainId = isHexStrict(chainId) ? chainId : \"0x\".concat(parseInt(chainId, 10).toString(16)); // Check if chainId changed and trigger event\n\n      this.configure({\n        chainConfig: _objectSpread$1(_objectSpread$1({}, this.config.chainConfig), {}, {\n          chainId: connectedHexChainId\n        })\n      });\n      await this.setupProvider(injectedProvider);\n    });\n  }\n\n}\n\nfunction createChainIdMiddleware(chainId) {\n  return (req, res, next, end) => {\n    if (req.method === \"solana_chainId\") {\n      res.result = chainId;\n      return end();\n    }\n\n    return next();\n  };\n}\nfunction createProviderConfigMiddleware(providerConfig) {\n  return (req, res, next, end) => {\n    if (req.method === \"solana_provider_config\") {\n      res.result = providerConfig;\n      return end();\n    }\n\n    return next();\n  };\n}\nfunction createJsonRpcClient(providerConfig) {\n  const {\n    chainId,\n    rpcTarget\n  } = providerConfig;\n  const fetchMiddleware = createFetchMiddleware({\n    rpcTarget\n  });\n  const networkMiddleware = mergeMiddleware([createChainIdMiddleware(chainId), createProviderConfigMiddleware(providerConfig), fetchMiddleware]);\n  return {\n    networkMiddleware,\n    fetchMiddleware\n  };\n}\n\nasync function getProviderHandlers(_ref) {\n  let {\n    privKey,\n    getProviderEngineProxy\n  } = _ref;\n\n  const transactionGenerator = serializedTx => {\n    const decodedTx = bs58.decode(serializedTx);\n    const tx = Transaction.populate(Message.from(decodedTx));\n    return tx;\n  };\n\n  const keyPairGenerator = () => {\n    return Keypair.fromSecretKey(Buffer.from(privKey, \"hex\"));\n  };\n\n  if (typeof privKey !== \"string\") throw WalletInitializationError.invalidParams(\"privKey must be a string\");\n  const keyPair = keyPairGenerator();\n  const providerHandlers = {\n    requestAccounts: async () => {\n      return [keyPair.publicKey.toBase58()];\n    },\n    getAccounts: async () => [keyPair.publicKey.toBase58()],\n    getPrivateKey: async () => privKey,\n    signTransaction: async req => {\n      var _req$params, _req$params2;\n\n      if (!((_req$params = req.params) !== null && _req$params !== void 0 && _req$params.message)) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n\n      const transaction = transactionGenerator((_req$params2 = req.params) === null || _req$params2 === void 0 ? void 0 : _req$params2.message);\n      transaction.partialSign(keyPair);\n      return transaction;\n    },\n    signMessage: async req => {\n      var _req$params3;\n\n      if (!((_req$params3 = req.params) !== null && _req$params3 !== void 0 && _req$params3.message)) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n\n      const signedMsg = nacl.sign.detached(req.params.message, keyPair.secretKey);\n      return signedMsg;\n    },\n    signAndSendTransaction: async req => {\n      var _req$params4, _req$params5;\n\n      if (!((_req$params4 = req.params) !== null && _req$params4 !== void 0 && _req$params4.message)) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n\n      const _providerEngineProxy = getProviderEngineProxy();\n\n      if (!_providerEngineProxy) throw ethErrors.provider.custom({\n        message: \"Provider is not initialized\",\n        code: 4902\n      });\n      const transaction = transactionGenerator((_req$params5 = req.params) === null || _req$params5 === void 0 ? void 0 : _req$params5.message);\n      transaction.sign(keyPair);\n      const sig = await _providerEngineProxy.request({\n        method: \"sendTransaction\",\n        params: [bs58.encode(transaction.serialize())]\n      });\n      return {\n        signature: sig\n      };\n    },\n    signAllTransactions: async req => {\n      var _req$params6, _req$params7;\n\n      if (!((_req$params6 = req.params) !== null && _req$params6 !== void 0 && _req$params6.message) || !((_req$params7 = req.params) !== null && _req$params7 !== void 0 && _req$params7.message.length)) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n\n      const signedTransactions = [];\n\n      for (const tx of ((_req$params8 = req.params) === null || _req$params8 === void 0 ? void 0 : _req$params8.message) || []) {\n        var _req$params8;\n\n        const transaction = transactionGenerator(tx);\n        transaction.partialSign(keyPair);\n        signedTransactions.push(transaction);\n      }\n\n      return signedTransactions;\n    }\n  };\n  return providerHandlers;\n}\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nclass SolanaPrivateKeyProvider extends BaseProvider {\n  constructor(_ref) {\n    let {\n      config,\n      state\n    } = _ref;\n    super({\n      config: {\n        chainConfig: _objectSpread(_objectSpread({}, config.chainConfig), {}, {\n          chainNamespace: CHAIN_NAMESPACES.SOLANA\n        })\n      },\n      state\n    });\n  }\n\n  async enable() {\n    if (!this.state.privateKey) throw ethErrors.provider.custom({\n      message: \"Private key is not found in state, plz pass it in constructor state param\",\n      code: 4902\n    });\n    await this.setupProvider(this.state.privateKey);\n    return this._providerEngineProxy.request({\n      method: \"eth_accounts\"\n    });\n  }\n\n  async setupProvider(privKey) {\n    const providerHandlers = await getProviderHandlers({\n      privKey,\n      getProviderEngineProxy: this.getProviderEngineProxy.bind(this)\n    });\n    const solanaMiddleware = createSolanaMiddleware(providerHandlers);\n    const engine = new JRPCEngine();\n    const {\n      networkMiddleware\n    } = createJsonRpcClient(this.config.chainConfig);\n    engine.push(this.getChainSwitchMiddleware());\n    engine.push(this.getAccountMiddleware());\n    engine.push(solanaMiddleware);\n    engine.push(networkMiddleware);\n    const provider = providerFromEngine(engine);\n    this.updateProviderEngineProxy(provider);\n    await this.lookupNetwork();\n  }\n\n  async updateAccount(params) {\n    if (!this._providerEngineProxy) throw ethErrors.provider.custom({\n      message: \"Provider is not initialized\",\n      code: 4902\n    });\n    const existingKey = await this._providerEngineProxy.request({\n      method: \"solanaPrivateKey\"\n    });\n\n    if (existingKey !== params.privateKey) {\n      await this.setupProvider(params.privateKey);\n\n      this._providerEngineProxy.emit(\"accountsChanged\", {\n        accounts: await this._providerEngineProxy.request({\n          method: \"requestAccounts\"\n        })\n      });\n    }\n  }\n\n  async switchChain(params) {\n    if (!this._providerEngineProxy) throw ethErrors.provider.custom({\n      message: \"Provider is not initialized\",\n      code: 4902\n    });\n    const chainConfig = this.getChainConfig(params.chainId);\n    this.update({\n      chainId: \"loading\"\n    });\n    this.configure({\n      chainConfig\n    });\n    const privKey = await this._providerEngineProxy.request({\n      method: \"solanaPrivateKey\"\n    });\n    await this.setupProvider(privKey);\n  }\n\n  async lookupNetwork() {\n    if (!this._providerEngineProxy) throw ethErrors.provider.custom({\n      message: \"Provider is not initialized\",\n      code: 4902\n    });\n    const health = await this._providerEngineProxy.request({\n      method: \"getHealth\",\n      params: []\n    });\n    const {\n      chainConfig\n    } = this.config;\n    if (health !== \"ok\") throw WalletInitializationError.rpcConnectionError(\"Failed to lookup network for following rpc target: \".concat(chainConfig.rpcTarget));\n    this.update({\n      chainId: chainConfig.chainId\n    });\n\n    if (this.state.chainId !== chainConfig.chainId) {\n      this.provider.emit(\"chainChanged\", this.state.chainId);\n      this.provider.emit(\"connect\", {\n        chainId: this.state.chainId\n      });\n    }\n\n    return this.state.chainId;\n  }\n\n  getChainSwitchMiddleware() {\n    const chainSwitchHandlers = {\n      addNewChainConfig: async req => {\n        if (!req.params) throw ethErrors.rpc.invalidParams(\"Missing request params\");\n        const {\n          chainId,\n          chainName,\n          rpcUrls,\n          blockExplorerUrls,\n          nativeCurrency\n        } = req.params;\n        if (!chainId) throw ethErrors.rpc.invalidParams(\"Missing chainId in chainParams\");\n        if (!rpcUrls || rpcUrls.length === 0) throw ethErrors.rpc.invalidParams(\"Missing rpcUrls in chainParams\");\n        if (!nativeCurrency) throw ethErrors.rpc.invalidParams(\"Missing nativeCurrency in chainParams\");\n        this.addChain({\n          chainNamespace: CHAIN_NAMESPACES.SOLANA,\n          chainId,\n          ticker: (nativeCurrency === null || nativeCurrency === void 0 ? void 0 : nativeCurrency.symbol) || \"SOL\",\n          tickerName: (nativeCurrency === null || nativeCurrency === void 0 ? void 0 : nativeCurrency.name) || \"Solana\",\n          displayName: chainName,\n          rpcTarget: rpcUrls[0],\n          blockExplorer: (blockExplorerUrls === null || blockExplorerUrls === void 0 ? void 0 : blockExplorerUrls[0]) || \"\"\n        });\n      },\n      switchSolanaChain: async req => {\n        if (!req.params) throw ethErrors.rpc.invalidParams(\"Missing request params\");\n        if (!req.params.chainId) throw ethErrors.rpc.invalidParams(\"Missing chainId\");\n        await this.switchChain(req.params);\n      }\n    };\n    const chainSwitchMiddleware = createChainSwitchMiddleware(chainSwitchHandlers);\n    return chainSwitchMiddleware;\n  }\n\n  getAccountMiddleware() {\n    const accountHandlers = {\n      updatePrivatekey: async req => {\n        if (!req.params) throw ethErrors.rpc.invalidParams(\"Missing request params\");\n        if (!req.params.privateKey) throw ethErrors.rpc.invalidParams(\"Missing privateKey\");\n        const {\n          privateKey\n        } = req.params;\n        await this.updateAccount({\n          privateKey\n        });\n      }\n    };\n    return createAccountMiddleware(accountHandlers);\n  }\n\n}\n\n_defineProperty(SolanaPrivateKeyProvider, \"getProviderInstance\", async params => {\n  const providerFactory = new SolanaPrivateKeyProvider({\n    config: {\n      chainConfig: params.chainConfig\n    }\n  });\n  await providerFactory.setupProvider(params.privKey);\n  return providerFactory;\n});\n\nclass SolanaWallet {\n  constructor(provider) {\n    _defineProperty(this, \"provider\", void 0);\n\n    this.provider = provider;\n  }\n\n  async requestAccounts() {\n    const accounts = await this.provider.request({\n      method: \"requestAccounts\",\n      params: {}\n    });\n    return accounts;\n  }\n\n  async signAndSendTransaction(transaction) {\n    const {\n      signature\n    } = await this.provider.request({\n      method: \"signAndSendTransaction\",\n      params: {\n        message: bs58.encode(transaction.serialize({\n          requireAllSignatures: false\n        }))\n      }\n    });\n    return {\n      signature\n    };\n  }\n\n  async signTransaction(transaction) {\n    const signedTransaction = await this.provider.request({\n      method: \"signTransaction\",\n      params: {\n        message: bs58.encode(transaction.serialize({\n          requireAllSignatures: false\n        }))\n      }\n    });\n    return signedTransaction;\n  }\n\n  async signAllTransactions(transactions) {\n    const messages = transactions.map(transaction => {\n      return bs58.encode(transaction.serialize({\n        requireAllSignatures: false\n      }));\n    });\n    const signedTransaction = await this.provider.request({\n      method: \"signAllTransactions\",\n      params: {\n        message: messages\n      }\n    });\n    return signedTransaction;\n  }\n\n  async signMessage(data) {\n    const response = await this.provider.request({\n      method: \"signMessage\",\n      params: {\n        message: data\n      }\n    });\n    return response;\n  }\n\n  async request(args) {\n    const result = await this.provider.request(args);\n    return result;\n  }\n\n}\n\nexport { PhantomInjectedProvider, SolanaPrivateKeyProvider, SolanaWallet, TorusInjectedProvider };\n//# sourceMappingURL=solanaProvider.esm.js.map\n"]},"metadata":{},"sourceType":"module"}